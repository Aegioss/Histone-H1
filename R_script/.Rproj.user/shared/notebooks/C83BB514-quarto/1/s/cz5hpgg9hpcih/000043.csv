"0",""
"0","peaks_genes1 <- mcols(subsetByOverlaps(TT_genesC1, peaksC1, type=""within""))$gene_name"
"0","writeLines(peaks_genes1, ""/home/franck/SCRATCH/fpan/Script/Analysis_image/GENE_LIST/peaks_potential_gene.txt"")"
"0",""
"0","peaks <- GRanges()"
"0","for (chr in runValue(seqnames(ratio_gr))){"
"0","  subset_gtf <- ratio_gr[seqnames(ratio_gr)==chr]"
"0","  score_vec <- subset_gtf[!is.na(subset_gtf$score)]"
"0","  min_value <- 0.01  "
"0","  nonzero_scores <- score_vec[score_vec$score > min_value]"
"0","  quantile_cutoff <- 0.90"
"0","  threshold <- quantile(nonzero_scores$score,quantile_cutoff)"
"0","  peaks <- c(peaks, nonzero_scores[nonzero_scores$score > threshold & nonzero_scores$score > min_value])"
"0","  }"
"0",""
"0","dummy2 <- ratio_gr"
"0","hits <- findOverlaps(dummy2, peaks, type = ""start"")"
"0","dummy2$score <- 0"
"0","dummy2$score[queryHits(hits)] <- peaks$score[subjectHits(hits)]"
"0",""
"0","KpGeTRdummy <- plotKaryotype(plot.type=1, genome = custom.genome, cytobands = cyto, chromosomes=mus_chrs, cex=1)"
