"0","interest <- c(""RNA_S11589Nr69"",""RNA_S11589Nr71"")"
"0","height_per_sample <- 1 / length(interest)"
"0","for(i in seq_along(mus_chrs)){"
"0","  nth_chr <- mus_chrs[i]"
"0","  chr_genes <- gtf_tpm[seqnames(gtf_tpm)==nth_chr]"
"0","  bin_size <- 1e6"
"0","  chr_length <- width(custom.genome)[i]"
"0","  bins <- tileGenome(seqlengths = setNames(chr_length, nth_chr),"
"0","                     tilewidth = bin_size, "
"0","                     cut.last.tile.in.chrom = TRUE)"
"0","  r <- 0"
"0","  expr_list <- GRangesList()"
"0","  kp <- plotKaryotype(genome=custom.genome, chromosomes=nth_chr, cytobands=cyto, plot.type=4)"
"0","    for(sample in interest){"
"0","      hits <- findOverlaps(bins, chr_genes) "
"0","      sum_expr <- tapply(mcols(chr_genes)[[sample]][subjectHits(hits)],"
"0","                         queryHits(hits), sum, na.rm=TRUE)"
"0","      expr_bins <- bins[as.numeric(names(sum_expr))]"
"0","      expr_bins$expr <- sum_expr"
"0","      expr_list[[sample]] <- expr_bins"
"0","    }"
"0","  max_y = max(expr_list[[interest[1]]]$expr, expr_list[[interest[2]]]$expr)"
"0","  kpArea(kp, data=expr_list[[interest[1]]], y=expr_list[[interest[1]]]$expr, ymax = max_y * 1.1, col = rgb(34/255, 139/255, 34/255, alpha = 0.6), "
"0","         border=NA, r0 = r, r1 = r + 0.4)"
"0","  kpLines(kp, chr=nth_chr, data = expr_list[[interest[1]]], y=expr_list[[interest[1]]]$expr, ymin= 0, ymax = max_y * 1.1, col=""forestgreen"", "
"0","          lwd=2, r0 = r, "
"0","          r1 = r + 0.4)"
"0","  kpPoints(kp, data=expr_list[[interest[1]]], y=expr_list[[interest[1]]]$expr, ymin= 0, ymax = max_y * 1.1, col=""blue"", "
"0","           cex=0.5, r0 = r, r1 = r + 0.4)"
"0","  kpAddLabels(kp, labels = substr(interest[1], nchar(interest[1])-1, nchar(interest[1])), r0 = r, "
"0","              r1 = r + 0.4, cex = 0.7, srt = 0, label.margin = 0.01)"
"0","  "
"0","  kpArea(kp, data=expr_list[[interest[2]]], y=expr_list[[interest[2]]]$expr, ymax = max_y * 1.1, col = rgb(34/255, 139/255, 34/255, alpha = 0.6), "
"0","       border=NA, r0 = 0.6, r1 = 1)"
"0","  kpLines(kp, chr=nth_chr, data = expr_list[[interest[2]]], y=expr_list[[interest[2]]]$expr, ymin= 0, ymax = max_y * 1.1, col=""forestgreen"", "
"0","          lwd=2, r0 = 0.6, "
"0","          r1 = 1)"
"0","  kpPoints(kp, data=expr_list[[interest[2]]], y=expr_list[[interest[2]]]$expr, ymin= 0, ymax = max_y * 1.1, col=""blue"", "
"0","           cex=0.5, r0 = 0.6, r1 = 1)"
"0","  kpAddLabels(kp, labels = substr(interest[2], nchar(interest[2])-1, nchar(interest[2])), r0 = 0.6, "
"0","              r1 = 1, cex = 0.7, srt = 0, label.margin = 0.01)"
"0","  kpAxis(kp, ymin = 0, ymax = max_y, r0 = 0, r1 = 0.4, cex = 1, numticks = 4)"
"0","  kpAxis(kp, ymin = 0, ymax = max_y, r0 = 0.6, r1 = 1, cex = 1, numticks = 4)"
"0","      "
"0","}"
