"0","interest <- c(""RNA_S11589Nr69"",""RNA_S11589Nr71"")"
"0","gap_ratio <- 0.1 "
"0","n_tracks <- length(interest)"
"0","height_per_sample <- (1 - (n_tracks - 1) * gap_ratio) / n_tracks"
"0","for(i in seq_along(mus_chrs)){"
"0","  nth_chr <- mus_chrs[i]"
"0","  chr_genes <- gtf_tpm[seqnames(gtf_tpm)==nth_chr]"
"0","  bin_size <- 1e6"
"0","  chr_length <- width(custom.genome)[i]"
"0","  bins <- tileGenome(seqlengths = setNames(chr_length, nth_chr),"
"0","                     tilewidth = bin_size, "
"0","                     cut.last.tile.in.chrom = TRUE)"
"0","  r <- 0"
"0","  kp <- plotKaryotype(genome=custom.genome, chromosomes=nth_chr, cytobands=cyto, plot.type=4)"
"0","    for(sample in interest){"
"0","      hits <- findOverlaps(bins, chr_genes) "
"0","      sum_expr <- tapply(mcols(chr_genes)[[sample]][subjectHits(hits)],"
"0","                         queryHits(hits), sum, na.rm=TRUE)"
"0","      expr_bins <- bins[as.numeric(names(sum_expr))]"
"0","      expr_bins$expr <- sum_expr"
"0","      "
"0","      kpArea(kp, data=expr_bins, y=expr_bins$expr, ymax = max(expr_bins$expr) * 1.1, col = rgb(34/255, 139/255, 34/255, alpha = 0.6), "
"0","             border=NA, r0 = r, r1 = r + height_per_sample)"
"0","      kpLines(kp, chr=nth_chr, data = expr_bins, y=expr_bins$expr, ymin= 0, ymax = max(expr_bins$expr) * 1.1, col=""forestgreen"", lwd=2, r0 = r, "
"0","              r1 = r + height_per_sample)"
"0","      kpPoints(kp, data=expr_bins, y=expr_bins$expr, ymin= 0, ymax = max(expr_bins$expr) * 1.1, col=""blue"", cex=0.5, "
"0","               r0 = r, r1 = r + height_per_sample)"
"0","      kpAddLabels(kp, labels = substr(sample, nchar(sample)-1, nchar(sample)), r0 = r - height_per_sample * 0.1,"
"0","                  r1 = r , cex = 0.7, srt = 0, label.margin = 0.01, pos = 1)"
"0","      kpAxis(kp, ymin = 0, ymax = max(expr_bins$expr) * 1.1, r0 = r, r1 = r + height_per_sample, cex = 1, numticks = 4)"
"0","      r <- r + height_per_sample + gap_ratio"
"0","  }"
"0","}"
